---
phase: 07-english-translation-pass
plan: 05
type: execute
wave: 4
depends_on: [07-01]
files_modified:
  - src/pages/Loading.tsx
  - src/pages/Report.tsx
  - src/lib/scoring.ts
  - public/locales/en/generating.json
  - public/locales/en/report.json
  - public/locales/en/common.json
  - src/@types/i18next.d.ts
autonomous: true
requirements:
  - TRANS-03
  - TRANS-06

must_haves:
  truths:
    - "Loading.tsx uses t() for all animated step messages, headings, error messages, and button text"
    - "Report.tsx uses t() for all section headings, labels, display text, error states, and CTA content"
    - "Scoring display functions (getScoreLabel, category labels) are translatable via report.json"
    - "The report page renders identically to pre-Phase-7"
    - "npm run build succeeds with zero errors"
  artifacts:
    - path: "public/locales/en/generating.json"
      provides: "All generating/loading page strings"
      contains: "steps"
    - path: "public/locales/en/report.json"
      provides: "All report page strings including section headings, labels, score display, CTA"
      contains: "sections"
    - path: "src/pages/Loading.tsx"
      provides: "Loading page using t() calls"
      contains: "useTranslation"
    - path: "src/pages/Report.tsx"
      provides: "Report page using t() calls"
      contains: "useTranslation"
    - path: "src/lib/scoring.ts"
      provides: "Score label and category label functions that accept t() for display"
  key_links:
    - from: "src/pages/Loading.tsx"
      to: "public/locales/en/generating.json"
      via: "useTranslation('generating')"
      pattern: "useTranslation.*generating"
    - from: "src/pages/Report.tsx"
      to: "public/locales/en/report.json"
      via: "useTranslation('report')"
      pattern: "useTranslation.*report"
---

<objective>
Extract all hardcoded strings from the Loading page and Report page into their respective namespaces. Also make score display labels (getScoreLabel, category labels) translatable.

Purpose: This plan completes the Phase 7 extraction by covering the two remaining pages (Loading and Report) and the scoring display layer. After this plan, every user-visible string in the app comes from i18n namespaces.
Output: Loading.tsx and Report.tsx fully using t() calls. generating.json and report.json populated. Scoring display labels translatable.
</objective>

<execution_context>
@C:/Users/Emil/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Emil/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-english-translation-pass/07-CONTEXT.md
@src/pages/Loading.tsx
@src/pages/Report.tsx
@src/lib/scoring.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Populate generating.json and report.json</name>
  <files>
    public/locales/en/generating.json
    public/locales/en/report.json
    public/locales/en/common.json
  </files>
  <action>
1. Populate `public/locales/en/generating.json`:
   ```json
   {
     "steps": [
       "Analyzing your technology stack...",
       "Evaluating your lead funnel...",
       "Scoring your scheduling & operations...",
       "Assessing your communication systems...",
       "Reviewing your follow-up & retention...",
       "Identifying revenue opportunities...",
       "Benchmarking against industry standards...",
       "Generating personalized recommendations..."
     ],
     "heading": "Generating Your AI Audit Report",
     "subtitle": "This takes about 15\u201320 seconds \u2014 please don't close this tab",
     "analyzing": "Analyzing...",
     "errors": {
       "missingFormData": "Missing form data. Please start over.",
       "missingNiche": "Missing niche selection. Please start over.",
       "reportFailed": "Report generation failed",
       "reportIssue": "Report generation encountered an issue."
     },
     "rateLimit": {
       "heading": "Too Many Submissions",
       "savedMessage": "Your audit data has been saved. You'll receive your report once the limit resets.",
       "defaultMessage": "Too many submissions. Please try again later."
     }
   }
   ```

2. Populate `public/locales/en/report.json`:
   ```json
   {
     "hero": {
       "nicheBadge": {
         "hs": "Home Services & Trades \u00b7 AI Business Audit",
         "re": "Real Estate \u00b7 AI Business Audit"
       },
       "reportTitle": "Business Audit Report \u00b7 {{date}}",
       "employees": "{{count}} employees",
       "revenue": "{{amount}} revenue",
       "overallScore": "Overall Score"
     },
     "scores": {
       "strong": "Strong",
       "moderate": "Moderate",
       "needsWork": "Needs Work",
       "criticalGap": "Critical Gap",
       "weight": "{{weight}}% weight"
     },
     "benchmark": {
       "above": "Above Average",
       "average": "Average",
       "below": "Below Average"
     },
     "sections": {
       "executiveSummary": "Executive Summary",
       "categoryScorecard": "Category Scorecard",
       "criticalGaps": "Top 3 Critical Gaps",
       "quickWins": "Quick Wins (30 Days)",
       "quickWinsSubtitle": "Things you can implement immediately with existing resources",
       "strategicRecs": "Strategic Recommendations (90 Days)",
       "strategicRecsSubtitle": "Larger investments with significant ROI potential",
       "competitorBenchmark": "Competitor Benchmark"
     },
     "categories": {
       "technology": "Technology & Software",
       "leads": "Lead Funnel & Marketing",
       "scheduling": {
         "hs": "Scheduling & Dispatch",
         "re": "Lead Management"
       },
       "communication": "Communication",
       "followUp": "Follow-Up & Retention",
       "operations": "Operations & Accountability",
       "financial": "Financial Operations"
     },
     "cta": {
       "heading": "Want Help Implementing These Recommendations?",
       "description": "Book a free 30-minute strategy call with the E&P Systems team. We'll review your audit results, prioritize your top opportunities, and show you exactly how we can help implement them.",
       "bookCall": "Book Your Free Strategy Call",
       "shareReport": "Share This Report",
       "noObligation": "No obligation \u00b7 No sales pressure \u00b7 Just strategy"
     },
     "errors": {
       "notFound": {
         "heading": "Report Not Found",
         "description": "This audit link is invalid or has expired. Start a new audit to generate a fresh report."
       },
       "fetchFailed": "Failed to load report. Please try again.",
       "noData": {
         "heading": "No Report Data Found",
         "description": "We couldn't find any report data. Start a new audit to generate a fresh report."
       },
       "timeout": {
         "heading": "Taking Longer Than Expected",
         "description": "Your report is still being generated. Try refreshing the page in a few minutes, or contact support if this persists."
       },
       "pending": {
         "heading": "Your Report is Being Generated...",
         "description": "Our AI is analyzing your audit responses. This usually takes 15-30 seconds."
       }
     },
     "share": {
       "share": "Share",
       "copied": "Copied!"
     },
     "executiveSummaryTemplate": {
       "intro": "Based on your responses, <strong>{{businessName}}</strong> scored <strong>{{score}}/100</strong> overall \u2014 placing you in the <strong>{{label}}</strong> category for {{nicheType}} of your size.",
       "strengths": "Your strongest areas are in <strong>{{areas}}</strong>, which suggests you have a solid operational foundation to build from.",
       "gaps": "However, significant gaps in <strong>{{areas}}</strong> represent your biggest opportunities. Businesses that close these gaps typically see <strong>20-40% revenue increases</strong> within 12 months through better lead conversion, retention, and operational efficiency.",
       "recommendation": "The recommendations in this report are based on your specific answers and industry benchmarks for {{nicheDescription}}.",
       "hsNicheType": "home service businesses",
       "reNicheType": "real estate teams",
       "hsNicheDescription": "{{industry}} businesses with {{employees}} employees",
       "reNicheDescription": "real estate teams with {{teamSize}}"
     },
     "footer": {
       "startNewAudit": "\u2190 Start a New Audit"
     }
   }
   ```

3. Update `src/@types/i18next.d.ts` to include all 5 namespace types:
   ```typescript
   import 'i18next';
   import type common from '../../public/locales/en/common.json';
   import type landing from '../../public/locales/en/landing.json';
   import type steps from '../../public/locales/en/steps.json';
   import type generating from '../../public/locales/en/generating.json';
   import type report from '../../public/locales/en/report.json';

   declare module 'i18next' {
     interface CustomTypeOptions {
       defaultNS: 'common';
       resources: {
         common: typeof common;
         landing: typeof landing;
         steps: typeof steps;
         generating: typeof generating;
         report: typeof report;
       };
     }
   }
   ```
  </action>
  <verify>
- `public/locales/en/generating.json` is valid JSON with all loading page strings
- `public/locales/en/report.json` is valid JSON with all report page strings
- `src/@types/i18next.d.ts` imports all 5 namespaces
- `npm run build` succeeds (TypeScript can resolve the JSON imports)
  </verify>
  <done>generating.json and report.json fully populated with all Loading and Report page strings. TypeScript declarations updated for all 5 namespaces.</done>
</task>

<task type="auto">
  <name>Task 2: Convert Loading.tsx to t() calls</name>
  <files>
    src/pages/Loading.tsx
  </files>
  <action>
1. Add import: `import { useTranslation } from 'react-i18next';`

2. Inside the component:
   ```typescript
   const { t } = useTranslation('generating');
   const { t: tc } = useTranslation('common');
   ```

3. Replace the `steps` const array:
   ```typescript
   const steps = t('steps', { returnObjects: true }) as string[];
   ```

4. Replace all hardcoded strings:
   - **Brand text:** `"E&P"` → `tc('brand.initials')`, `"E&P Systems"` → `tc('brand.name')`
   - **Heading:** `"Generating Your AI Audit Report"` → `t('heading')`
   - **Subtitle:** `"This takes about 15–20 seconds..."` → `t('subtitle')`
   - **Progress label:** `"Analyzing..."` → `t('analyzing')`
   - **Error messages:**
     - `"Missing form data. Please start over."` → `t('errors.missingFormData')`
     - `"Missing niche selection. Please start over."` → `t('errors.missingNiche')`
     - `"Report generation failed"` → `t('errors.reportFailed')`
     - `"Report generation encountered an issue."` → `t('errors.reportIssue')`
   - **Rate limit:**
     - `"Too Many Submissions"` → `t('rateLimit.heading')`
     - `"Your audit data has been saved..."` → `t('rateLimit.savedMessage')`
     - The default rate limit message from API: keep `body.message` as-is (server-provided), with `t('rateLimit.defaultMessage')` as fallback
   - **Buttons:**
     - `"Retry"` → `tc('buttons.retry')`
     - `"Skip to Report"` → `tc('buttons.skipToReport')`

5. Move the `steps` array inside the component since it now depends on the `t` hook (hooks can't be called at module level).
  </action>
  <verify>
- `npm run build` succeeds
- `npm run dev` — trigger the loading page:
  - Animated step messages cycle correctly
  - Heading, subtitle, progress label render correctly
  - Brand text renders
  - If rate limited, the rate limit UI shows correct text
  </verify>
  <done>Loading.tsx fully converted to t() calls. All animated steps, headings, error messages, rate limit text, and buttons come from i18n namespaces.</done>
</task>

<task type="auto">
  <name>Task 3: Convert Report.tsx and scoring display labels to t() calls</name>
  <files>
    src/pages/Report.tsx
    src/lib/scoring.ts
  </files>
  <action>
1. **Report.tsx** — add translation hooks:
   ```typescript
   import { useTranslation } from 'react-i18next';
   // Inside component:
   const { t } = useTranslation('report');
   const { t: tc } = useTranslation('common');
   ```

2. Replace all hardcoded strings in Report.tsx. Key mappings:

   **Header:**
   - `"E&P"` → `tc('brand.initials')`, `"E&P Systems"` → `tc('brand.name')`
   - `"Share"` / `"Copied!"` → `t('share.share')` / `t('share.copied')`  (or use common buttons)
   - `"Download PDF"` → `tc('buttons.downloadPdf')`

   **Report hero:**
   - Niche badge: `isHS ? t('hero.nicheBadge.hs') : t('hero.nicheBadge.re')`
   - Report title with date: `t('hero.reportTitle', { date: new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' }) })`
   - `"{count} employees"` → `t('hero.employees', { count: formState.step1.employeeCount })`
   - `"{amount} revenue"` → `t('hero.revenue', { amount: formState.step1.annualRevenue })`
   - `"Overall Score"` → `t('hero.overallScore')`

   **Score labels:** The `getScoreLabel()` function returns hardcoded English strings. Two approaches:
   - **Option A (preferred):** Create a translatable wrapper in Report.tsx:
     ```typescript
     const scoreLabels: Record<string, string> = {
       Strong: t('scores.strong'),
       Moderate: t('scores.moderate'),
       'Needs Work': t('scores.needsWork'),
       'Critical Gap': t('scores.criticalGap'),
     };
     const translateScoreLabel = (score: number) => {
       const key = getScoreLabel(score);
       return scoreLabels[key] ?? key;
     };
     ```
   - **Option B:** Modify getScoreLabel to accept a t function

   Use translateScoreLabel where `getScoreLabel` is called for display.

   **Benchmark labels:** Same pattern for BenchmarkBadge:
   ```typescript
   const benchmarkLabels = {
     above: { label: t('benchmark.above'), ... },
     average: { label: t('benchmark.average'), ... },
     below: { label: t('benchmark.below'), ... },
   };
   ```

   **Category labels in scoring.ts:**
   Currently, `computeScores()` returns hardcoded `label` strings (e.g., "Technology & Software"). These are used in the report UI. Two approaches:
   - **Option A (preferred):** Keep scoring.ts untouched (it returns English labels), and in Report.tsx, create a `translateCategory` function that maps category keys to translated labels:
     ```typescript
     const categoryLabels: Record<string, string> = {
       technology: t('categories.technology'),
       leads: t('categories.leads'),
       scheduling: isHS ? t('categories.scheduling.hs') : t('categories.scheduling.re'),
       communication: t('categories.communication'),
       followUp: t('categories.followUp'),
       operations: t('categories.operations'),
       financial: t('categories.financial'),
     };
     ```
     Then use `categoryLabels[cat.category]` instead of `cat.label` when rendering.
   - **Option B:** Modify computeScores to accept a label resolver function

   Option A is cleaner — keeps scoring.ts as a pure calculation engine and handles display text at the UI layer.

   **Section headings:**
   - `"Executive Summary"` → `t('sections.executiveSummary')`
   - `"Category Scorecard"` → `t('sections.categoryScorecard')`
   - `"Top 3 Critical Gaps"` → `t('sections.criticalGaps')`
   - `"Quick Wins (30 Days)"` → `t('sections.quickWins')`
   - `"Things you can implement immediately..."` → `t('sections.quickWinsSubtitle')`
   - `"Strategic Recommendations (90 Days)"` → `t('sections.strategicRecs')`
   - `"Larger investments with significant ROI potential"` → `t('sections.strategicRecsSubtitle')`
   - `"Competitor Benchmark"` → `t('sections.competitorBenchmark')`

   **CTA section:**
   - All CTA text from `t('cta.*')`

   **Error states (branded 404, fetch error, timeout, pending, no data):**
   - `"Report Not Found"` → `t('errors.notFound.heading')`
   - `"This audit link is invalid..."` → `t('errors.notFound.description')`
   - `"Start a New Audit"` → `tc('buttons.startNewAudit')`
   - `"Failed to load report..."` → `t('errors.fetchFailed')`
   - And so on for all error states

   **Executive summary template fallback:**
   The template executive summary contains complex strings with embedded JSX. Use `Trans` component or interpolation:
   - For the template executive summary paragraphs, use the `executiveSummaryTemplate.*` keys with `{{variable}}` interpolation
   - For the `<strong>` embedded text, use `Trans` component:
     ```tsx
     <Trans
       i18nKey="executiveSummaryTemplate.intro"
       ns="report"
       values={{ businessName, score: scores.overall, label: overallLabel.toLowerCase() }}
       components={{ strong: <strong className="text-foreground" />, scoreStrong: <strong style={{ color: getScoreColor(scores.overall) }} /> }}
     />
     ```
     This requires adjusting the JSON string to use numbered or named component placeholders. Claude's discretion on exact approach — the key point is the template text must come from i18n.

   **Footer:**
   - `"← Start a New Audit"` → `t('footer.startNewAudit')`

3. **ScoreBar component** (inside Report.tsx):
   - The `label` prop includes weight: `${cat.label} (${cat.weight}% weight)`. Use:
     ```typescript
     const displayLabel = `${categoryLabels[cat.category]} (${t('scores.weight', { weight: cat.weight })})`;
     ```

4. **scoring.ts** — keep as-is. The `getScoreLabel()`, `getBenchmark()`, and `computeScores()` functions return English strings used as keys. Translation happens at the display layer in Report.tsx. Do NOT modify scoring.ts for i18n — this preserves the "scoring is language-agnostic" principle.

   Exception: if `getScoreLabel` return values are displayed directly elsewhere (they are — in ScoreBar's badge), the translation wrapper in Report.tsx must cover those call sites too.
  </action>
  <verify>
- `npm run build` succeeds
- `npm run dev` — complete an audit and view the report:
  - All section headings render correctly
  - Overall score circle shows "Overall Score" label
  - Score bars show category labels with weight percentages
  - Score badges show "Strong", "Moderate", etc.
  - Benchmark badges show "Above Average", "Average", "Below Average"
  - CTA section renders with all text
  - Footer link shows "← Start a New Audit"
- Error states render correctly (test by visiting /report/nonexistent-uuid)
- Executive summary template text renders with interpolated values
  </verify>
  <done>Report.tsx fully converted to t() calls. All section headings, score display labels, benchmark labels, category labels, CTA text, error states, and footer come from i18n namespaces. scoring.ts remains unchanged — translation happens at the display layer.</done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. `npm run test` passes
3. Complete a full audit flow end-to-end: Landing → Steps 1-8 → Generating → Report
4. All text on every page comes from i18n namespaces (no hardcoded English remains)
5. Report page: all sections, headings, labels, scores, CTA render correctly
6. Loading page: animated steps, heading, progress, error states render correctly
7. Visit /report/nonexistent-id to test 404 error state
8. All 5 namespace JSON files are valid and complete
</verification>

<success_criteria>
- Loading.tsx uses t() for ALL user-visible text
- Report.tsx uses t() for ALL user-visible text
- generating.json and report.json are complete
- Score display labels (Strong, Moderate, etc.) are translatable via report.json
- Category labels are translatable via report.json
- scoring.ts is unchanged — scoring is language-agnostic
- Build passes with zero errors
- All pages render identically to pre-Phase-7
</success_criteria>

<output>
After completion, create `.planning/phases/07-english-translation-pass/07-05-SUMMARY.md`
</output>
