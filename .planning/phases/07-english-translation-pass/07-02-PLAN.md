---
phase: 07-english-translation-pass
plan: 02
type: execute
wave: 2
depends_on: [07-01]
files_modified:
  - src/pages/AuditForm.tsx
  - src/components/audit/AuditFormComponents.tsx
  - public/locales/en/common.json
  - public/locales/en/steps.json
autonomous: true
requirements:
  - TRANS-06

must_haves:
  truths:
    - "AuditForm.tsx uses t() calls for all UI chrome: step labels, niche badges, nav buttons, validation error header, save toast"
    - "AuditFormComponents.tsx StepHeader uses t() for 'Step X of 8' text"
    - "AuditFormComponents.tsx RatingButtons uses t() for satisfaction labels"
    - "AuditFormComponents.tsx StyledSelect placeholder uses t() for 'Select an option...'"
    - "The STEP_LABELS array is loaded from common.json namespace"
    - "npm run build succeeds with zero errors"
  artifacts:
    - path: "src/pages/AuditForm.tsx"
      provides: "Audit form page with all chrome text served from i18n"
      contains: "useTranslation"
    - path: "src/components/audit/AuditFormComponents.tsx"
      provides: "Form primitives with translatable default text"
      contains: "useTranslation"
    - path: "public/locales/en/common.json"
      provides: "Updated common strings including step labels and rating labels"
    - path: "public/locales/en/steps.json"
      provides: "Step titles and subtitles for StepHeader"
  key_links:
    - from: "src/pages/AuditForm.tsx"
      to: "public/locales/en/common.json"
      via: "useTranslation('common')"
      pattern: "useTranslation.*common"
    - from: "src/components/audit/AuditFormComponents.tsx"
      to: "public/locales/en/common.json"
      via: "useTranslation('common')"
      pattern: "useTranslation"
---

<objective>
Extract all hardcoded strings from the AuditForm page chrome (headers, step labels, nav buttons, validation errors, niche badge) and the shared form components (StepHeader, RatingButtons defaults, StyledSelect placeholder) into i18n namespaces.

Purpose: This plan clears the "shell" of the audit wizard so that all navigation, validation, and chrome text comes from i18n. Step-specific content (form field labels, hints, option labels) is deferred to plans 07-03 and 07-04.
Output: AuditForm.tsx and AuditFormComponents.tsx fully using t() calls for all chrome text.
</objective>

<execution_context>
@C:/Users/Emil/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Emil/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-english-translation-pass/07-CONTEXT.md
@src/pages/AuditForm.tsx
@src/components/audit/AuditFormComponents.tsx
@public/locales/en/common.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add audit form chrome strings to common.json and steps.json</name>
  <files>
    public/locales/en/common.json
    public/locales/en/steps.json
  </files>
  <action>
1. Update `public/locales/en/common.json` — add these keys (merge with existing):
   ```json
   {
     "stepLabels": ["BUSINESS", "TECHNOLOGY", "LEADS", "SCHEDULING", "COMMUNICATION", "FOLLOW-UP", "OPERATIONS", "FINANCIAL"],
     "stepLabelsAlt": {
       "step4hs": "SCHEDULING",
       "step4re": "LEAD MGMT"
     },
     "audit": {
       "nicheBadge": {
         "hs": "Home Services & Trades Audit",
         "re": "Real Estate Teams & Brokerages Audit"
       }
     },
     "rating": {
       "labels": ["Very Unsatisfied", "Unsatisfied", "Neutral", "Satisfied", "Very Satisfied"]
     },
     "form": {
       "selectPlaceholder": "Select an option...",
       "selectAll": "Select all that apply",
       "required": "required",
       "optional": "Optional"
     }
   }
   ```

2. Populate `public/locales/en/steps.json` with step titles and subtitles. Use `isHS`-conditional keys where titles differ:
   ```json
   {
     "step1": {
       "title": "Tell Us About Your Business",
       "subtitle": "Basic info to personalize your audit report"
     },
     "step2": {
       "title": "Your Technology & Software Stack",
       "subtitle": "Let's understand the tools powering your business today"
     },
     "step3": {
       "title": "Lead Funnel & Marketing",
       "subtitle": "How you attract, respond to, and convert new leads"
     },
     "step4": {
       "hs": {
         "title": "Scheduling & Dispatching",
         "subtitle": "How you manage your calendar, crew, and daily operations"
       },
       "re": {
         "title": "Lead Management & Follow-Up",
         "subtitle": "How you nurture leads from inquiry through closing"
       }
     },
     "step5": {
       "hs": {
         "title": "Customer Communication",
         "subtitle": "How you stay connected with customers at every stage"
       },
       "re": {
         "title": "Client Communication",
         "subtitle": "How you stay connected with customers at every stage"
       }
     },
     "step6": {
       "hs": {
         "title": "Follow-Up & Customer Retention",
         "subtitle": "How you stay connected after the sale and build long-term loyalty"
       },
       "re": {
         "title": "Follow-Up & Client Retention",
         "subtitle": "How you stay connected after the sale and build long-term loyalty"
       }
     },
     "step7": {
       "title": "Operations & Accountability",
       "subtitle": "How you measure performance and run a tight operation"
     },
     "step8": {
       "title": "Financial Operations",
       "subtitle": "The final piece \u2014 how you price, invoice, and manage your money"
     }
   }
   ```
   Note: Steps where HS and RE have the same title/subtitle use flat keys. Steps where they differ use `hs`/`re` sub-keys. Claude's discretion on the exact nesting approach — the key point is that the step components can look up the right title based on the `isHS` boolean.
  </action>
  <verify>
- `public/locales/en/common.json` is valid JSON with new keys merged
- `public/locales/en/steps.json` is valid JSON with all 8 step title/subtitle entries
- No duplicate or conflicting keys
  </verify>
  <done>common.json updated with step labels, rating labels, form placeholders, audit chrome strings. steps.json populated with all 8 step titles and subtitles with niche variants where needed.</done>
</task>

<task type="auto">
  <name>Task 2: Convert AuditForm.tsx and AuditFormComponents.tsx to t() calls</name>
  <files>
    src/pages/AuditForm.tsx
    src/components/audit/AuditFormComponents.tsx
  </files>
  <action>
1. **AuditForm.tsx** — add `useTranslation`:
   ```typescript
   import { useTranslation } from 'react-i18next';
   // Inside component:
   const { t } = useTranslation('common');
   const { t: ts } = useTranslation('steps');
   ```

2. Replace hardcoded strings in AuditForm.tsx:

   **STEP_LABELS array** — replace static const with t() call:
   ```typescript
   const stepLabels = t('stepLabels', { returnObjects: true }) as string[];
   ```
   And for the step4 override:
   ```typescript
   const step4Label = isHS ? t('stepLabelsAlt.step4hs') : t('stepLabelsAlt.step4re');
   const tabLabels = [...stepLabels];
   tabLabels[3] = step4Label;
   ```

   **Header brand:**
   - `"E&P"` → `t('brand.initials')`
   - `"E&P Systems"` → `t('brand.name')`
   - `"Step {currentStep} of 8"` → `t('stepOf', { current: currentStep, total: 8 })`

   **Niche badge:**
   - `"Home Services & Trades Audit"` / `"Real Estate Teams & Brokerages Audit"` → `isHS ? t('audit.nicheBadge.hs') : t('audit.nicheBadge.re')`

   **Validation error header:**
   - `"Please fix the following:"` → `t('validation.fixFollowing')`

   **Navigation buttons:**
   - `"Back to Home"` → `t('buttons.backToHome')`
   - `"Back"` → `t('buttons.back')`
   - `"Next Step"` → `t('buttons.next')`
   - `"Generate My AI Audit Report"` → `t('buttons.generateReport')`
   - `"Save Progress"` / `"Saved!"` → `savedToast ? t('buttons.saved') : t('buttons.save')`

3. **AuditFormComponents.tsx** — add `useTranslation`:
   ```typescript
   import { useTranslation } from 'react-i18next';
   ```

   **StepHeader** — convert the "Step X of 8" text:
   ```typescript
   export function StepHeader({ step, title, subtitle }: { step: number; title: string; subtitle?: string }) {
     const { t } = useTranslation('common');
     return (
       <div className="mb-8">
         <div className="text-xs font-bold text-muted-foreground uppercase tracking-widest mb-1">
           {t('stepOf', { current: step, total: 8 })}
         </div>
         <h2 ...>{title}</h2>
         {subtitle && <p ...>{subtitle}</p>}
       </div>
     );
   }
   ```
   Note: `title` and `subtitle` remain as string props — the calling step components will pass t() values. StepHeader only translates its own "Step X of 8" chrome.

   **RatingButtons** — translate default labels:
   ```typescript
   export function RatingButtons({ value, onChange, labels }: { ... }) {
     const { t } = useTranslation('common');
     const ratingLabels = labels ?? (t('rating.labels', { returnObjects: true }) as string[]);
     ...
   }
   ```
   Remove the hardcoded default `labels` parameter value and fall back to t() instead.

   **StyledSelect** — translate default placeholder:
   ```typescript
   export function StyledSelect({ ..., placeholder }: { ...; placeholder?: string }) {
     const { t } = useTranslation('common');
     const placeholderText = placeholder ?? t('form.selectPlaceholder');
     ...
   }
   ```
   Remove the hardcoded default `placeholder = "Select an option..."` and fall back to t().

4. **Validation messages in AuditForm.tsx** — the `validateStep` function returns hardcoded error strings. Replace them with t() calls:
   ```typescript
   function validateStep(step: number, state: AuditFormState, t: TFunction): string[] {
   ```
   Pass `t` from the component scope. Replace each error string:
   - `"Business name is required"` → `t('validation.businessNameRequired')`
   - `"Your name is required"` → `t('validation.nameRequired')`
   - etc.

   Alternatively, since `validateStep` is outside the component, it cannot use hooks. Options:
   - **Option A:** Move validateStep inside the component (it's small)
   - **Option B:** Pass `t` as a parameter
   - **Option C:** Keep error keys and look up display text at render time

   Claude's discretion — pick the cleanest approach. Option B (pass t as param) is straightforward.
  </action>
  <verify>
- `npm run build` succeeds with zero errors
- `npm run dev` — navigate through audit form steps:
  - Header shows "Step X of 8" correctly
  - Tab labels show BUSINESS, TECHNOLOGY, etc. (from common.json)
  - Niche badge shows correctly for both HS and RE
  - Back/Next/Save buttons show correct text
  - Validation errors display correctly
- Rating buttons show "Very Unsatisfied" through "Very Satisfied"
- Select dropdowns show "Select an option..." as placeholder
  </verify>
  <done>AuditForm.tsx and AuditFormComponents.tsx fully converted to t() calls for all UI chrome. Step labels, nav buttons, validation messages, rating labels, and select placeholders all served from i18n namespaces.</done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. `npm run test` passes
3. Navigate through entire audit flow (Steps 1-8) — all chrome text renders correctly
4. Validation errors appear with correct text when fields are empty
5. Save button shows "Save Progress" / "Saved!" correctly
6. Step tabs show correct labels including the HS/RE Step 4 variant
7. No hardcoded English strings remain in AuditForm.tsx or AuditFormComponents.tsx chrome (field labels in steps are addressed in 07-03/07-04)
</verification>

<success_criteria>
- AuditForm.tsx uses t() for ALL chrome text (headers, nav, validation, badges)
- AuditFormComponents.tsx uses t() for StepHeader counter, RatingButtons labels, StyledSelect placeholder
- STEP_LABELS loaded from common.json
- Step titles/subtitles defined in steps.json
- Build passes with zero errors
- Audit form UI renders identically to pre-Phase-7
</success_criteria>

<output>
After completion, create `.planning/phases/07-english-translation-pass/07-02-SUMMARY.md`
</output>
